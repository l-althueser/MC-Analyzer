# MuensterTPC-Simulation-Analyzer
Data analysis tools for the geant4 Muenster TPC simulation data.
The *MuensterTPC-Simulation-Analyzer* is used for doing data processing on simulation data generated by [*MuensterTPC-Simulation*](https://github.com/l-althueser/MuensterTPC-Simulation). This software stands under the BSD license (see [LICENSE](./LICENSE.md)).

## Installation Prerequisites
This software is only tested and intended for use with Linux (or Windows Subsystem for Linux). Various incompatibilities can occur on other operation systems. The *MuensterTPC-Simulation-Analyzer* is an extended macro for the [*Data Analysis Framework ROOT*](https://root.cern.ch/) and thus requires an installation of ROOT 5.34/34 (ROOT 6 is not supported at this point).  
  
The installation of ROOT can be checked by running it in the terminal, just type:
```
root
```
If the ROOT environment is started you can continue reading, otherwise a proper installation of ROOT is needed.  

## Installing the MuensterTPC-Simulation-Analyzer
There are two ways to install this little software. Option one is to youse the GitHub interface to download and extract the master branch to a specific directory ([download link](https://github.com/l-althueser/MuensterTPC-Simulation-Analyzer/archive/master.zip)). Option two will follow the real GitHub way of doing this ..  

First `cd` to the folder you want the Analyzer to be installed. Then run:
```
git clone https://github.com/l-althueser/MuensterTPC-Simulation-Analyzer.git
```

## MuensterTPC-Simulation-Analyzer Tutorial
This section assumes that the MuensterTPC-Simulation-Analyzer is installed and all prerequisits are given.  

To start the Analyzer `cd` to the installation directory and type:
```
root
.x Analyzer.C
```
Now an interface asking for the report file should be shown. Just follow the given instructions.

### The output file/file format
You can simply view the generated simulation data with any version of [ROOT](https://root.cern.ch/). Just type ..
```
root
new TBrowser
```
.. and navigate to the generated `events.root` file. Now you can do the normal click and drag routine of ROOT.  

The output file has an specific file format which is described in the following.
#### Top directory
| Name | type | description |  
| --- | --- | --- |
| nbeventstosimulate | TParameter<int> | number of simulated events |  

#### TDirectory::t1
| Name | type | description |  
| --- | --- | --- |
| eventid | int | event number |
| ntpmthits | int | |
| nbpmthits | int | |
| pmthits | int | |
| etot | float | total G4 energy deposit in this event |
| nsteps | int | number of G4 steps |
| trackid  | int | track ID |
| type  | string | particle type |
| parentid  | int | track ID of parent |
| parenttype  | string | particle type of parent |
| creaproc  | string | process that created this particle |
| edproc  | string | process for this particular energy deposit |
| xp  | vector<float> | x coordinate of energy deposit (mm) |
| yp  | vector<float> | y coordinate of energy deposit (mm) |
| zp  | vector<float> | z coordinate of energy deposit (mm) |
| ed  | vector<float> | energy deposit (keV) |
| time  | vector<float> | timestamp of the current particle/trackid |
| type_pri  | string | particle type of primary  |
| e_pri  | vector<float> | energy of primary (keV) |
| xp_pri  | vector<float> | x coordinate of primary particle (mm) |
| yp_pri  | vector<float> | y coordinate of primary particle (mm) |
| zp_pri  | vector<float> | z coordinate of primary particle (mm) |

### Overview of the Geant4 Simulation
![Overview_01](/drawings/muensterTPCsim_overview_01.png)
![Overview_02](/drawings/muensterTPCsim_overview_02.png)
![Overview_PMTholder](/drawings/muensterTPCsim_pmtholder_top_wireframe.pdf.jpg)
