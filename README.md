# Monte Carlo Analyzer
[![license](https://img.shields.io/github/license/l-althueser/MC-Analyzer.svg)](./LICENSE.md) [![release](https://img.shields.io/github/release/l-althueser/MC-Analyzer.svg)](https://github.com/l-althueser/MC-Analyzer/releases) [![issues](https://img.shields.io/github/issues/l-althueser/MC-Analyzer.svg)](https://github.com/l-althueser/MC-Analyzer/issues) [![pr](https://img.shields.io/github/issues-pr/l-althueser/MC-Analyzer.svg)](https://github.com/l-althueser/MC-Analyzer/pulls) [![download master](https://img.shields.io/badge/download-master-green.svg)](https://github.com/l-althueser/MC-Analyzer/archive/master.zip)

Data analysis tool for [Geant4](http://geant4.cern.ch/) simulation data. The `MC-Analyzer` is a data processor for data generated by the [`MuensterTPC-MC`](https://github.com/l-althueser/MuensterTPC-MC) or other similar TPC MCs. This software stands under the BSD license (see [LICENSE](./LICENSE.md)).

## Installation Prerequisites
This software is only tested and intended for use with Linux (or Windows Subsystem for Linux). Various incompatibilities can occur on other operation systems. The `MC-Analyzer` is an Jupyter notebook which uses the [Data Analysis Framework `ROOT`](https://root.cern.ch/) and thus requires an installation of `ROOT` (`ROOT` 5.X and **6.X** is supported) and Jupyter (Anaconda).
  
If the `ROOT` environment and a notebook server is started you can continue reading, otherwise a proper [installation of `ROOT`](https://root.cern.ch/downloading-root) in Anaconda is needed. (The old C++ based scripts are available through the version control.)  

See the `*.ipynb` files for analysis scripts and example plots.

### The output file/file format
You can simply view the generated simulation data with any version of [`ROOT`](https://root.cern.ch/). Just type ..
```
root
new TBrowser
```
.. and navigate to the generated `events.root` file. Now you can do the normal click and drag routine of `ROOT`.  

The input data file has an specific file format which is described in the following.
#### Top directory
| Name | type | description |  
| --- | --- | --- |
| G4VERSION | TName<string> | version of geant4 |  
| MC_TAG | TName<string> | name of the simulation toolkit (if this key is not found `XENON1T` is assumed) |  

#### TDirectory::events
| Name | type | description |  
| --- | --- | --- |
| nbevents | TParameter<int> | number of simulated events |  

#### TDirectory::events/events
| Name | type | description |  
| --- | --- | --- |
| eventid | int | event number |
| ntpmthits | int | |
| nbpmthits | int | |
| pmthits | int | |
| etot | float | total G4 energy deposit in this event |
| nsteps | int | number of G4 steps |
| trackid  | int | track ID |
| type  | string | particle type |
| parentid  | int | track ID of parent |
| parenttype  | string | particle type of parent |
| creaproc  | string | process that created this particle |
| edproc  | string | process for this particular energy deposit |
| xp  | vector<float> | x coordinate of energy deposit (mm) |
| yp  | vector<float> | y coordinate of energy deposit (mm) |
| zp  | vector<float> | z coordinate of energy deposit (mm) |
| ed  | vector<float> | energy deposit (keV) |
| time  | vector<float> | timestamp of the current particle/trackid |
| type_pri  | string | particle type of primary  |
| e_pri  | vector<float> | energy of primary (keV) |
| xp_pri  | vector<float> | x coordinate of primary particle (mm) |
| yp_pri  | vector<float> | y coordinate of primary particle (mm) |
| zp_pri  | vector<float> | z coordinate of primary particle (mm) |

### Overview of supported Geant4 simulations  

#### [*MuensterTPC-MC*](https://github.com/l-althueser/MuensterTPC-Simulation)  
![Overview_01](/drawings/muensterTPCsim_overview_01.png)
![Overview_02](/drawings/muensterTPCsim_overview_02.png)
![Overview_PMTholder](/drawings/muensterTPCsim_pmtholder_top_wireframe.pdf.jpg)
